The codes are porting from [coreutils-5.0]